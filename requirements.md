# 要件定義書: 簡易スケジューリングツール MVP

## 目次

- [1. 概要・はじめに](#1-概要・はじめに)
- [2. スコープ](#2-スコープ)
- [3. 機能要件](#3-機能要件)
- [4. 非機能要件](#4-非機能要件)
- [5. UI/UX要件](#5-uiux要件)
- [6. データ要件](#6-データ要件)
- [7. 技術要件](#7-技術要件)
- [8. 将来的な考慮事項（MVP以降）](#8-将来的な考慮事項mvp以降)

## 1. 概要・はじめに

### 1.1. プロジェクト概要

本プロジェクトは、コンテキストスイッチコストを考慮したタスクスケジューリングのコンセプトに基づき、小規模チームや個人が利用可能なMVPを開発します。中核技術として量子アニーリング（QA）シミュレーションを用い、タスクの切り替えコストを最小化したスケジュール案を提供します。

### 1.2. 背景

先行するシミュレーション（`qa_scheduling_colab`）により、特定条件下でQAが有効なスケジュールを生成できることを確認。本MVP開発は、この技術をアプリケーションとして具現化し、実用性と課題を検証する第一歩です。

### 1.3. 目的

- QAシミュレーションを用いたスケジューリング最適化機能を持つMVPを開発・提供
- ユーザー定義のタスク・担当者・時間枠に基づき、コンテキストスイッチコストを最小化したスケジュール案を提示
- シンプルな利用シナリオでの有効性と実用性を検証
- 初期ユーザーからのフィードバックを収集し、機能拡張や改善に活用

### 1.4. 対象ユーザー

- 小規模プロジェクトチームのリーダー／マネージャー
- 個人のタスク管理ユーザー
- 研究室や小規模ワークショップのスケジュール担当者

## 2. スコープ

### 2.1. 対象範囲 (In Scope)

- **入力機能:**
  - タスクリスト入力（タスク名、タスク種類）
  - 担当者リスト入力（担当者名）
  - スケジュール期間（タイムスロット数）の指定
- **コア機能:**
  - `QUBO`問題を定式化
  - `dwave-neal`シミュレータでシミュレーテッドアニーリングを実行
  - コンテキストスイッチコスト最小化を目的関数に含む
  - 制約（各タスク1回、同時刻1タスク）を組み込む
  - エネルギー縮退防止のための `base_cost` を導入
- **出力機能:**
  - 最適化スケジュールをテーブル形式で表示
  - 制約充足可否のステータス表示
- **インターフェース:**
  - WebベースUI（Streamlitなど）

### 2.2. 対象範囲外 (Out of Scope)

- 複雑制約（タスク依存、締め切り、スキルレベル等）
- リアルタイム更新機能
- ユーザーアカウント管理
- データ永続化／共有機能
- 外部カレンダー連携
- 実機接続（D-Waveハードウェア）
- 高度UI/UX（ドラッグ＆ドロップ等）
- シナリオ比較機能

## 3. 機能要件

以下の機能要件を満たすこと。

| ID   | 要件名             | 詳細                                                                                     |
| ---- | ------------------ | ---------------------------------------------------------------------------------------- |
| FR1  | タスク情報入力     | - `タスク名`（一意文字列）<br>- `タスク種類`（選択 or 自由入力）                         |
| FR2  | 担当者情報入力     | - `担当者名`（文字列）のリストを入力                                                    |
| FR3  | スケジュール期間入力 | - `タイムスロット数`（正の整数）を指定                                                 |
| FR4  | スケジュール実行   | - 入力情報を基に最適化プロセスを開始（ボタンクリック）                                    |
| FR5  | QAシミュレーション | - `QUBO`を構築し、`dwave-neal`ライブラリでシミュレーテッドアニーリング                |
| FR6  | QUBO定式化         | - コンテキストスイッチコスト最小化<br>- 実行回数制約（1回）<br>- 同時タスク数制約（≦1回）<br>- `base_cost` 基本コスト |
| FR7  | 結果表示           | - スケジュールテーブルを表示                                                            |
| FR8  | ステータス表示     | - 制約充足の有無をステータス表示                                                        |

## 4. 非機能要件

| ID   | 分類         | 要件内容                                                                                     |
| ---- | ------------ | -------------------------------------------------------------------------------------------- |
| NFR1 | パフォーマンス | MVPスコープ内（例: タスク≦10, 担当者≦3, スロット≦10）の典型的な問題に対し、最適化計算が許容可能な時間内（例: 30秒以内）に完了すること。 |
| NFR2 | ユーザビリティ | UIはシンプルで直感的であり、IT専門家でなくても基本的な操作（入力、実行、結果確認）が行えること。 |
| NFR3 | 信頼性       | QAシミュレーションプロセスが安定して実行され、何らかの結果（最適解またはそれに準ずる解）を出力すること。基本的な入力エラーチェックを行うこと。 |
| NFR4 | 保守性       | コード（特にQUBO定式化とQA実行部分）は、適切にコメント化され、構造化されており、後からの修正や理解が容易であること。 |
| NFR5 | 移植性       | （Webアプリの場合）主要なモダンブラウザで動作すること。（デスクトップアプリの場合）一般的なOS（Windows/Mac/Linuxのいずれか）で動作すること。 |

## 5. UI/UX要件

- **インターフェース:** Webブラウザベースのシングルページアプリケーションを推奨（アクセシビリティのため）。
- **画面構成（案）:**
  - **入力セクション:**
    - タスク入力エリア（例：テーブル形式でタスク名と種類を追加・編集・削除）
    - 担当者入力エリア（例：リスト形式で名前を追加・削除）
    - タイムスロット数入力フィールド
    - 「スケジュール作成」ボタン
  - **出力セクション:**
    - 最適化実行中のステータス表示エリア（例：「計算中...」）
    - 結果表示エリア（スケジュールテーブル、結果ステータス）

## 6. データ要件

- **入力データ:**
  - タスク名: 文字列
  - タスク種類: 文字列（例: 'A', 'B', '開発', 'テスト'）
  - 担当者名: 文字列
  - タイムスロット数: 正の整数
- **内部データ:**
  - QUBOモデル（線形バイアス、二次バイアス、オフセット）
  - QAソルバー設定（例: num_reads）
- **出力データ:**
  - スケジュール割り当て: (タスクID, 担当者ID, タイムスロットID) の集合
  - 実行ステータス: 文字列（成功、警告など）
- **永続化:** MVPではデータ永続化（ファイル保存、DB保存）は行わない。

## 7. 技術要件

- **プログラミング言語:** Python 3.x
- **コアライブラリ:** dimod, dwave-neal
- **UIフレームワーク（推奨）:** **Streamlit** (PythonのみでシンプルなWeb UIを迅速に構築可能)
  - 代替案: Flask + HTML/CSS/JS, PyQt/Tkinter (デスクトップ)
- **実行環境:** ローカルPC環境、またはシンプルなクラウド環境（例: Streamlit Cloud）
- **QA実装:** **入力データに基づき動的にQUBOを構築し、dwave-nealで解くロジックをPythonで実装することが必須要件。**

## 8. 将来的な考慮事項（MVP以降）

- スコープ外（2.2節）に記載した機能の追加。
- より高度な制約条件への対応。
- 実際の量子アニーリングマシン（D-Wave Leapなど）への接続オプション。
- パフォーマンスチューニング（大規模問題への対応）。
- ユーザーフィードバックに基づくUI/UXの改善。